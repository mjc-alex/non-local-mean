## 第一章 CUDA的异构并行计算
### 并行计算
- 注意分析数据相关性，决定串行与并行
- 应用程序中有两种基本的并行类型
	- 数据并行
		当可以同时处理许多数据时，这就是数据并行。数据并行的重点在于利用多核系统对数据进行分配。
	- 任务并行
		当许多任务或函数可以独立地、大规模地并行执行时，这就是任务并行。任务并行的重点在于利用多核系统对任务进行分配。 
	本书的重点便是如何使用CUDA编程解决数据并行问题
- 数据并行程序设计
	- 第一步是把数据依据线程进行划分，块划分（block partitioning）和周期划分 （cyclic partitioning）。如何在线程中分配数据不仅与数据的物理储存方式密切相关，并且与每个线程的执行次序也有很大关系。组织线程的方式对程序的性能有很大的影响
### 异构计算
- ![](images/Pasted%20image%2020240107204757.png)
- 峰值计算性能是用来评估计算容量的一个指标，通常定义为每秒能处理的单精度或双精度浮点运算的数量。峰值性能通常用GFlops（每秒十亿次浮点运算）或TFlops（每秒万 亿次浮点运算）来表示。内存带宽是从内存中读取或写入数据的比率。内存带宽通常用 GB/s表示。
- 为了支持使用CPU＋GPU异构系统架构来执行应用程序，NVIDIA设计了 一个被称为CUDA(Compute Unified Device Architecture)的编程模型。
- GPU上的线程是高度轻量级的。在一个典型的系统中会有成千上万的线程排队等待工作。如果GPU必须等待一组线程执行结束，那么它只要调用另一组线程执行其他任务即可。GPU的核是用来处理大量并发的、轻量级的线程，以最大限度地提高吞吐量。
- 一个CUDA程序包含了以下两个部分的混合：在CPU上运行的主机代码，在GPU上运行的设备代码。
	![](images/Pasted%20image%2020240107210337.png)
## 第二章 CUDA编程模型
### 概述
- 一个典型的CUDA程序实现流程遵循以下模式。 
1. 把数据从CPU内存拷贝到GPU内存。 
2. 调用核函数对存储在GPU内存中的数据进行操作。 
3. 将数据从GPU内存传送回到CPU内存。
- CUDA编程模型假设系统是由一个主机和一个设备组成的，而且各自拥有独立的内 存。核函数是在设备上运行的。
### 内存管理
- 在GPU内存层次结构中，最主要的两种内存是全局内存和共享内存。全局类似于CPU 的系统内存，而共享内存类似于CPU的缓存。然而GPU的共享内存可以由CUDA C的内核 直接控制。
- 当数据被转移到GPU的全局内存后，主机端调用核函数在GPU上进行数组求和。一旦 内核被调用，控制权立刻被传回主机，这样的话，当核函数在GPU上运行时，主机可以执行其他函数。因此，内核与主机是异步的。
### 线程管理
![](images/Pasted%20image%2020240110153626.png)
由一个内核启动所产生的所有线程统称为一个网格。**同一网格中的所有线程共享相同的全局内存空间**。一个网格由多个线程块构成,相同块内的线程可以通过：同步、共享内存进行协作，不同线程块内的线程不能协作。
- 线程依靠以下两个坐标变量来区分彼此。 ·blockIdx（线程块在线程格内的索引） ·threadIdx（块内的线程索引） 这些变量是核函数中需要预初始化的内置变量。坐标变量是基于uint3定义的CUDA内置的向量类型，是一个包含3个无符号整数的 结构，可以通过x、y、z三个字段来指定。
- CUDA可以组织三维的网格和块。网格和块的维度由下列两个内置变量指定。 ·blockDim（线程块的维度，用每个线程块中的线程数来表示） ·gridDim（线程格的维度，用每个线程格中的线程数来表示） 它们是dim3类型的变量，是基于uint3定义的整数型向量，用来表示维度。当定义一个 dim3类型的变量时，所有未指定的元素都被初始化为1。dim3类型变量中的每个组件可以 通过它的x、y、z字段获得。
- 通常，一个线程格会被组织成线程块的二维数组形式，一个线程块会被组织成线程的 三维数组形式。
- 在CUDA程序中有两组不同的网格和块变量：手动定义的dim3数据类型和预定义的 uint3数据类型。在主机端，作为内核调用的一部分，你可以使用dim3数据类型定义一个网格和块的维度。当执行核函数时，CUDA运行时会生成相应的内置预初始化的网格、块和线程变量，它们在核函数内均可被访问到且为unit3类型。手动定义的dim3类型的网格和块变量仅在主机端可见，而unit3类型的内置预初始化的网格和块变量仅在设备端可见。
### CUDA C扩展
#### 函数限定符
```
__device__: 声明在设备上的函数，无法被CPU调用，只能由GPU端程序调用，只能被__global__或__device__函数调用
__global__: 声明的函数称为kernel函数。该函数只能由CPU端调用，执行在GPU上，Kernel函数类型必须是void,返回类型必须为空
__host__： 声明在主机上执行的函数，仅在CPU端调用，一般可省略，只有该函数同时存在被设备和主机调用的情况才需要添加。且无法与__global__联用。
```
#### 变量限定符
```
__device__: 位于设备端全局内存中
__constant__: 全局不可修改的变量，只能在设备端使用
__shared__: 声明在共享存储中的变量，仅供block中所有thread共享访存，退出kernel后失效。
```
#### 核函数
`kernel_name <<<grid, block>>(argument)`
test2
